---
import { communities } from "@/data/communities"
import Layout from "@/layouts/Layout.astro"
import { i18nKeys } from "@/lib/i18n-runtime"
import { Icon } from "astro-icon/components"
---

<Layout
	title="Список сообществ"
	description={`Каталог ${communities.length} 12‑шаговых сообществ: темы, контакты и ссылки.`}
	titleKey={i18nKeys.communities.title}
	descriptionKey={i18nKeys.communities.description}
>
	<!-- <Warning color="bg-green-50 border-green-200 text-green-700">
		<b>Информация на 2025 год составляет 57 сообщества.</b> Некоторые сообщества образованы
		из других, как некие группы, с фокусом на что-либо. Их намного больше, но их крайне сложно
		найти из-за закрытой информации.
		<b>Если у вас есть информация о каком-либо сообществе, будем рады обратной связи.</b>
	</Warning> -->

	<div class="flex gap-3 justify-center items-center flex-wrap">
		<p class="text-[color:var(--muted)] text-sm font-medium">
			<span data-i18n="communities.updatedNote">Группа обновляется.</span> <b><u>(30.06.2025)</u></b>
		</p>
		<a
			href="https://t.me/all12_contacts"
			class="bg-[color:var(--surface)] border border-[color:var(--border)] hover:bg-[color:var(--bg)] transition-colors duration-75 ease-in flex items-center gap-1 text-[color:var(--text)] px-2 py-1 rounded-md"
			target="_blank"
			><Icon name="mdi:telegram" /><span class="font-medium">Telegram</span></a
		>
	</div>
	<section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 items-start gap-4">
		{
			communities &&
				[...communities]
					.sort((a, b) => (b.wikipedia ? 1 : 0) - (a.wikipedia ? 1 : 0))
					.map(item => (
						<article class="w-full flex flex-col text-center bg-[color:var(--surface)] border border-[color:var(--border)] rounded-xl">
							<div class="p-6">
								<h2 class="text-xl font-bold leading-tight mb-1">{item.title}</h2>
								<p class="line-clamp-1 text-[color:var(--muted)]">
									{item.description}
								</p>
							</div>
							<div
								class="flex gap-3 items-center border-t border-[color:var(--border)] rounded-t-xl p-3 justify-between"
							>
								<span class="text-sm">
									<span data-i18n="communities.infoLabel">Информация:</span>{" "}
									<b>
										<span class="text-sm" data-i18n={item.find === true ? "communities.yes" : "communities.no"}>
											{item.find === true ? "Есть." : "Нет."}
										</span>
									</b>
								</span>
								<span class="text-sm">
									<span data-i18n="communities.foundedLabel">Основан:</span>{" "}
									<b>
										<span class="text-sm" data-i18n={item.since ? undefined : "communities.unknown"}>
											{item.since || "Неизвестно."}
										</span>
									</b>
								</span>
							</div>

							<a
								href={item.tg_group_link_topic}
								aria-label={item.title}
								target="_blank"
								class={`p-3 text-sm text-[color:var(--text)] border-t border-[color:var(--border)] flex items-center gap-1 justify-center hover:bg-[color:var(--bg)] transition-colors duration-75 ease-in ${item.wikipedia ? "rounded-b-none" : "rounded-b-xl"}`}
							>
								<Icon name="mdi:telegram" />
								<span class="font-medium" data-i18n="communities.goTopic">Перейти к подтеме сообщества</span>
							</a>
							{item.wikipedia && (
								<a
									href={item.wikipedia}
									aria-label={item.title}
									target="_blank"
									class="p-3 text-sm text-[color:var(--muted)] border-t border-[color:var(--border)] rounded-b-xl flex items-center gap-1 justify-center hover:bg-[color:var(--bg)] transition-colors duration-75 ease-in"
								>
									<Icon name="mdi:wikipedia" />
									<span class="font-medium" data-i18n="communities.wikiPage">Wikipedia страница</span>
								</a>
							)}
						</article>
					))
		}
	</section>
</Layout>
