import{c as B,Q as L,R as y,T as U,U as x,V as H,h as m,W as S,X as re,Y as Z,Z as $,_ as G,$ as ae,a0 as J,a1 as K,a2 as V,a3 as z,a4 as D,a5 as se,g as q,F as ne,a6 as fe,a7 as ie,a8 as P,a9 as A,aa as te,ab as Q,o as le,ac as X,ad as oe,ae as ue,af as ce,ag as he,ah as O,ai as ve,aj as de,ak as pe}from"./render.D5j66Yhw.js";class ge{anchor;#r=new Map;#a=new Map;#e=new Map;#s=new Set;#n=!0;constructor(a,s=!0){this.anchor=a,this.#n=s}#f=()=>{var a=B;if(this.#r.has(a)){var s=this.#r.get(a),l=this.#a.get(s);if(l)L(l),this.#s.delete(s);else{var u=this.#e.get(s);u&&(this.#a.set(s,u.effect),this.#e.delete(s),u.fragment.lastChild.remove(),this.anchor.before(u.fragment),l=u.effect)}for(const[t,f]of this.#r){if(this.#r.delete(t),t===a)break;const r=this.#e.get(f);r&&(y(r.effect),this.#e.delete(f))}for(const[t,f]of this.#a){if(t===s||this.#s.has(t))continue;const r=()=>{if(Array.from(this.#r.values()).includes(t)){var i=document.createDocumentFragment();re(f,i),i.append(x()),this.#e.set(t,{effect:f,fragment:i})}else y(f);this.#s.delete(t),this.#a.delete(t)};this.#n||!l?(this.#s.add(t),U(f,r,!1)):r()}}};#i=a=>{this.#r.delete(a);const s=Array.from(this.#r.values());for(const[l,u]of this.#e)s.includes(l)||(y(u.effect),this.#e.delete(l))};ensure(a,s){var l=B,u=Z();if(s&&!this.#a.has(a)&&!this.#e.has(a))if(u){var t=document.createDocumentFragment(),f=x();t.append(f),this.#e.set(a,{effect:H(()=>s(f)),fragment:t})}else this.#a.set(a,H(()=>s(this.anchor)));if(this.#r.set(l,a),u){for(const[r,o]of this.#a)r===a?l.unskip_effect(o):l.skip_effect(o);for(const[r,o]of this.#e)r===a?l.unskip_effect(o.effect):l.skip_effect(o.effect);l.oncommit(this.#f),l.ondiscard(this.#i)}else m&&(this.anchor=S),this.#f()}}function Te(e,a,s=!1){m&&G();var l=new ge(e),u=s?ae:0;function t(f,r){if(m){const i=J(e)===K;if(f===i){var o=V();z(o),l.anchor=o,D(!1),l.ensure(f,r),D(!0);return}}l.ensure(f,r)}$(()=>{var f=!1;a((r,o=!0)=>{f=!0,t(o,r)}),f||t(!1,null)},u)}function ke(e,a){return a}function _e(e,a,s){for(var l=[],u=a.length,t,f=a.length,r=0;r<u;r++){let c=a[r];U(c,()=>{if(t){if(t.pending.delete(c),t.done.add(c),t.pending.size===0){var d=e.outrogroups;Y(X(t.done)),d.delete(t),d.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var o=l.length===0&&s!==null;if(o){var i=s,h=i.parentNode;pe(h),h.append(i),e.items.clear()}Y(a,!o)}else t={pending:new Set(a),done:new Set},(e.outrogroups??=new Set).add(t)}function Y(e,a=!0){for(var s=0;s<e.length;s++)y(e[s],a)}var W;function we(e,a,s,l,u,t=null){var f=e,r=new Map;{var o=e;f=m?z(se(o)):o.appendChild(x())}m&&G();var i=null,h=ne(()=>{var v=s();return oe(v)?v:v==null?[]:X(v)}),c,d=!0;function F(){_.fallback=i,Ee(_,c,f,a,l),i!==null&&(c.length===0?(i.f&A)===0?L(i):(i.f^=A,I(i,null,f)):U(i,()=>{i=null}))}var n=$(()=>{c=q(h);var v=c.length;let b=!1;if(m){var g=J(f)===K;g!==(v===0)&&(f=V(),z(f),D(!1),b=!0)}for(var N=new Set,T=B,C=Z(),k=0;k<v;k+=1){m&&S.nodeType===fe&&S.data===ie&&(f=S,b=!0,D(!1));var M=c[k],p=l(M,k),E=d?null:r.get(p);E?(E.v&&P(E.v,M),E.i&&P(E.i,k),C&&T.unskip_effect(E.e)):(E=me(r,d?f:W??=x(),M,p,k,u,a,s),d||(E.e.f|=A),r.set(p,E)),N.add(p)}if(v===0&&t&&!i&&(d?i=H(()=>t(f)):(i=H(()=>t(W??=x())),i.f|=A)),v>N.size&&te(),m&&v>0&&z(V()),!d)if(C){for(const[j,ee]of r)N.has(j)||T.skip_effect(ee.e);T.oncommit(F),T.ondiscard(()=>{})}else F();b&&D(!0),q(h)}),_={effect:n,items:r,outrogroups:null,fallback:i};d=!1,m&&(f=S)}function R(e){for(;e!==null&&(e.f&de)===0;)e=e.next;return e}function Ee(e,a,s,l,u){var t=a.length,f=e.items,r=R(e.effect.first),o,i=null,h=[],c=[],d,F,n,_;for(_=0;_<t;_+=1){if(d=a[_],F=u(d,_),n=f.get(F).e,e.outrogroups!==null)for(const p of e.outrogroups)p.pending.delete(n),p.done.delete(n);if((n.f&A)!==0)if(n.f^=A,n===r)I(n,null,s);else{var v=i?i.next:r;n===e.effect.last&&(e.effect.last=n.prev),n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),w(e,i,n),w(e,n,v),I(n,v,s),i=n,h=[],c=[],r=R(i.next);continue}if((n.f&O)!==0&&L(n),n!==r){if(o!==void 0&&o.has(n)){if(h.length<c.length){var b=c[0],g;i=b.prev;var N=h[0],T=h[h.length-1];for(g=0;g<h.length;g+=1)I(h[g],b,s);for(g=0;g<c.length;g+=1)o.delete(c[g]);w(e,N.prev,T.next),w(e,i,N),w(e,T,b),r=b,i=T,_-=1,h=[],c=[]}else o.delete(n),I(n,r,s),w(e,n.prev,n.next),w(e,n,i===null?e.effect.first:i.next),w(e,i,n),i=n;continue}for(h=[],c=[];r!==null&&r!==n;)(o??=new Set).add(r),c.push(r),r=R(r.next);if(r===null)continue}(n.f&A)===0&&h.push(n),i=n,r=R(n.next)}if(e.outrogroups!==null){for(const p of e.outrogroups)p.pending.size===0&&(Y(X(p.done)),e.outrogroups?.delete(p));e.outrogroups.size===0&&(e.outrogroups=null)}if(r!==null||o!==void 0){var C=[];if(o!==void 0)for(n of o)(n.f&O)===0&&C.push(n);for(;r!==null;)(r.f&O)===0&&r!==e.fallback&&C.push(r),r=R(r.next);var k=C.length;if(k>0){var M=t===0?s:null;_e(e,C,M)}}}function me(e,a,s,l,u,t,f,r){var o=(f&ue)!==0?(f&ce)===0?le(s,!1,!1):Q(s):null,i=(f&he)!==0?Q(u):null;return{v:o,i,e:H(()=>(t(a,o??s,i??u,r),()=>{e.delete(l)}))}}function I(e,a,s){if(e.nodes)for(var l=e.nodes.start,u=e.nodes.end,t=a&&(a.f&A)===0?a.nodes.start:s;l!==null;){var f=ve(l);if(t.before(l),l===u)return;l=f}}function w(e,a,s){a===null?e.effect.first=s:a.next=s,s===null?e.effect.last=a:s.prev=a}export{ke as a,we as e,Te as i};
